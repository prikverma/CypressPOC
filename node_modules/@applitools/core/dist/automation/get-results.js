"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeGetResults = void 0;
function makeGetResults({ eyes, logger: mainLogger }) {
    return async function getResults({ settings, logger = mainLogger, } = {}) {
        logger = logger.extend(mainLogger);
        logger.log('Command "getResults" is called with settings', settings);
        return Promise.all(Array.from(eyes.storage.values(), async (item) => {
            try {
                const [eyes] = await Promise.all([item.eyes, ...item.jobs]);
                const [result] = await eyes.getResults({ settings, logger });
                return { ...result, environment: eyes.test.environment };
            }
            catch (error) {
                logger.fatal('Command "getResults" received an error', error, 'during performing with settings', settings);
                throw error;
            }
        }));
    };
}
exports.makeGetResults = makeGetResults;
