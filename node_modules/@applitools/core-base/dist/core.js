"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeCore = void 0;
const logger_1 = require("@applitools/logger");
const requests_1 = require("./server/requests");
const open_eyes_1 = require("./open-eyes");
const open_functional_session_1 = require("./open-functional-session");
const locate_1 = require("./locate");
const locate_text_1 = require("./locate-text");
const extract_text_1 = require("./extract-text");
const close_batch_1 = require("./close-batch");
const delete_test_1 = require("./delete-test");
const get_account_info_1 = require("./get-account-info");
function makeCore({ agentId = 'core-base', concurrency, cwd = process.cwd(), logger: defaultLogger, }) {
    const logger = (0, logger_1.makeLogger)({ logger: defaultLogger, format: { label: 'core-base' } });
    logger.log(`Core is initialized in directory ${cwd} for agent ${agentId}`);
    const requests = (0, requests_1.makeCoreRequestsWithCache)({ logger });
    return {
        get concurrency() {
            return concurrency;
        },
        openEyes: (0, open_eyes_1.makeOpenEyes)({ requests, agentId, concurrency, cwd, logger }),
        openFunctionalSession: (0, open_functional_session_1.makeOpenFunctionalSession)({ requests, agentId, concurrency, cwd, logger }),
        locate: (0, locate_1.makeLocate)({ requests, agentId, logger }),
        locateText: (0, locate_text_1.makeLocateText)({ requests, agentId, logger }),
        extractText: (0, extract_text_1.makeExtractText)({ requests, agentId, logger }),
        closeBatch: (0, close_batch_1.makeCloseBatch)({ requests, agentId, logger }),
        deleteTest: (0, delete_test_1.makeDeleteTest)({ requests, agentId, logger }),
        getAccountInfo: (0, get_account_info_1.makeGetAccountInfo)({ requests, agentId, logger }),
        logEvent: requests.logEvent,
    };
}
exports.makeCore = makeCore;
