/* @applitools/dom-capture@11.2.5 */
function __captureDom() {
  var captureDom=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e=function(){const t=function(t){return function(){function e(t,e=0){const n=t.charCodeAt(e);return n>=55296&&n<56320?1024*(n-55296)+(t.charCodeAt(e+1)-56320)+65536:56320<=n&&n<=57343?-1:n}var n=function(t,n){const o=[];let r=0;for(let a=0;a<t.length;++a){const s=e(t,a);let c=0;s>0&&(c=s<128?1:s<2048?2:s<65536?3:s<2097152?4:s<67108864?5:6),r+c>n?(o.push(a),r=c):r+=c}return o};const o=n,r="WIP",a="SUCCESS",s="SUCCESS_CHUNKED",c="ERROR";var u=function(t,e,n={}){const u=function(t,{chunkByteLength:e=0}={}){if(t){if(t.value){if(e){if(!t.chunks)try{const n=JSON.stringify(t.value);t.chunks=o(n,e),t.chunks.length>0&&(t.from=0,t.value=n)}catch(t){return{status:c,error:t.message}}if(t.from>=0)return{status:s,value:t.value.substring(t.from,t.from=t.chunks.shift()),done:!t.from}}return{status:a,value:t.value}}return t.error?{status:c,error:t.error}:{status:r}}return{status:c,error:"unexpected poll request received - cannot find state of current operation"}}((t=t||{})[e],n);return(u.status===a||u.status===c||u.status===s&&u.done)&&(t[e]=null),u};const i=u;var l={chunkify:n,pollify:function(t,e,n){return o=>function(){return e[n]||(e[n]={},t.apply(null,arguments).then((t=>e[n].value=t)).catch((t=>e[n].error=t.message))),i(e,n,o)}},poll:u,absolutizeUrl:function(t,e){if(function(t){try{return new URL(t),!0}catch(t){return!1}}(t))return t;let n=!0;try{n=t!==decodeURI(t)}catch(t){n=!0}try{const o=new URL(t,e).href;return n?o:decodeURI(o)}catch(e){return n?t:decodeURI(t)}},isInlineFrame:function(t){return t.contentDocument&&t.contentDocument.location&&!/^https?:$/.test(t.contentDocument.location.protocol)},isAccessibleFrame:function(t){try{const e=t.contentDocument;return Boolean(e&&e.defaultView&&e.defaultView.frameElement)}catch(t){return!1}}};const d=/url\((?!['"]?:)['"]?([^'")]*)['"]?\)/;var f={EYES_NAMESPACE:"__EYES__APPLITOOLS__",DOM_CAPTURE_KEY:"domCaptureResult",NODE_TYPES:{ELEMENT:1,TEXT:3,DOCUMENT_FRAGMENT:11},DEFAULT_STYLE_PROPS:["background-repeat","background-origin","background-position","background-color","background-image","background-size","border-width","border-color","border-style","color","display","font-size","font-weight","font-family","line-height","margin","opacity","overflow","padding","visibility","text-align","position","border-radius","z-index"],DEFAULT_RECT_PROPS:["width","height","top","left"],DEFAULT_IGNORED_TAG_NAMES:["HEAD","SCRIPT"]};const{NODE_TYPES:m}=f;function h(t){return Array.prototype.filter.call(t.parentNode.childNodes,(e=>e.tagName===t.tagName)).indexOf(t)+1}var p=function(e){var n=t.implementation.createHTMLDocument(""),o=n.createElement("style");return o.textContent=e,n.body.appendChild(o),o.sheet},g=function(t){const e=Array.from(t.attributes).find((t=>"href"===t.name.toLowerCase()));return e&&e.value},y=function(t){if(t.nodeName&&"LINK"===t.nodeName.toUpperCase()&&t.attributes){const e=new Map(Array.from(t.attributes,(t=>[t.name.toLowerCase(),t.value.toLowerCase()])));return"stylesheet"===e.get("rel")||"style"===e.get("as")&&["preload","prefetch"].includes(e.get("rel"))}return!1};const w=g,C=y;const{absolutizeUrl:E,isInlineFrame:T}=l,b=p,N=g,S=y,{NODE_TYPES:$}=f;const{absolutizeUrl:A,isInlineFrame:R}=l,_=function(t){const e=t?t.match(d):void 0;return e?e[1]:e},D=async function({bgImages:t,timeout:e=5e3,Image:n=window.Image}){return(await Promise.all(Array.from(t).map((t=>{return Promise.race([new Promise((e=>{const o=new n;o.onload=()=>e({url:t,width:o.naturalWidth,height:o.naturalHeight}),o.onerror=()=>e(),o.src=t})),(o=e,new Promise((t=>{setTimeout(t,o)})))]);var o})))).reduce(((t,e)=>(e&&(t[e.url]={width:e.width,height:e.height}),t)),{})},P=function t(e){if(!e.ownerDocument)return"";let n="",o=e,r=e.ownerDocument,a=r.defaultView.frameElement;for(;o!==r&&(!o||o.nodeType!==m.DOCUMENT_FRAGMENT);)n=`${o.tagName}[${h(o)}]/${n}`,o=o.parentNode;return a&&(n=`${t(a)},${n}`),n.replace(/\/$/,"")},U=function({parseCss:t,CSSImportRule:e,absolutizeUrl:n,getCssFromCache:o,unfetchedToken:r}){return function a(s,c){let u,i="";try{const l=t(s);for(const t of Array.from(l.cssRules))if(t instanceof e){const e=n(t.href,c),s=o(e);if(void 0!==s){const{bundledCss:t,unfetchedResources:n}=a(s,e);n&&(u=new Set(n)),i=`${i}${t}`}else u=new Set([e]),i=`\n${r}${e}${r}`}}catch(t){console.log(`error during getBundledCssFromCssText, styleBaseUrl=${c}`,t)}var l,d;return i=`${i}${l=s,d=c,`\n/** ${d} **/\n${l}`}`,{bundledCss:i,unfetchedResources:u}}},v=p,O=function(t){const e=["before","after"];try{let n=[];return e.forEach((e=>{const o=t.ownerDocument.defaultView.getComputedStyle(t,`:${e}`);o&&"none"!==o.getPropertyValue("content")&&n.push(e)})),n.join("_and_")}catch(t){return!1}},F=function(t,{fetchTimeLimit:e}={}){return async function(n){const o=new AbortController,r=[t(n,{cache:"force-cache",signal:o.signal}).then((t=>{if(t.ok)return t.text();console.log("/failed to fetch (status "+t.status+") css from: "+n+"/")})).catch((t=>{console.log("/failed to fetch (error "+t.toString()+") css from: "+n+"/")}))];return Number.isNaN(Number(e))||r.push(new Promise((t=>setTimeout(t,e))).then((()=>o.abort()))),Promise.race(r)}},I=function({getCssFromCache:t,absolutizeUrl:e}){return function(n,o){let r,a,s;if(n&&function(t){return t.nodeName&&"STYLE"===t.nodeName.toUpperCase()}(n))r=Array.from(n.childNodes).map((t=>t.nodeValue)).join(""),a=o;else if(n&&C(n)){const c=w(n);!function(t){return t&&t.startsWith("data:")}(c)?(a=e(c,o),r=t(a)):(a=o,r=c.match(/,(.+)/)[1]),s=void 0===r}return{cssText:r,styleBaseUrl:a,isUnfetched:s}}},k=function({extractCssFromNode:t,getBundledCssFromCssText:e,unfetchedToken:n}){return function(o,r){const{styleBaseUrl:a,cssText:s,isUnfetched:c}=t(o,r);let u,i="";if(s){const{bundledCss:t,unfetchedResources:n}=e(s,a);i+=t,u=new Set(n)}else c&&(i+=`${n}${a}${n}`,u=new Set([a]));return{bundledCss:i,unfetchedResources:u}}},L=function(e){return async function(n=t){const o={},r=Date.now(),a=[];return function t(n,o,r,a){function c(t){if(a.push(async function(t,n,o){let r,a;t&&S(t)&&(a=E(N(t),n),r=await e(a),void 0!==r&&(o[a]=r)),r&&await s(r,a,o)}(t,o,r)),t.nodeType===$.ELEMENT)return"IFRAME"===t.tagName.toUpperCase()?i(t):u(t)}async function u(t){Array.prototype.map.call(t.childNodes,c)}async function i(e){if(u(e),e.contentDocument)try{const n=T(e)?e.baseURI:e.contentDocument.location.href;t(e.contentDocument,n,r,a)}catch(e){console.log(e)}}c(n.documentElement)}(n,n.location.href,o,a),await Promise.all(a),console.log("[prefetchAllCss]",Date.now()-r),function(t){return o[t]};async function s(t,n,o){try{const r=b(t),a=[];for(const t of Array.from(r.cssRules))t instanceof CSSImportRule&&a.push((async()=>{const r=E(t.href,n),a=await e(r);o[r]=a,void 0!==a&&await s(a,r,o)})());await Promise.all(a)}catch(t){console.log(`error during fetchBundledCss, resourceUrl=${n}`,t)}}}},{NODE_TYPES:x,DEFAULT_STYLE_PROPS:M,DEFAULT_RECT_PROPS:V,DEFAULT_IGNORED_TAG_NAMES:B}=f;return function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}((async function({doc:e=t,styleProps:n=M,rectProps:o=V,ignoredTagNames:r=B,addStats:a=!1,fetchTimeLimit:s=3e4}={}){
/* MARKER FOR TEST - DO NOT DELETE */
arguments[1]&&(e=arguments[1]),arguments[2]&&(a=arguments[2]),arguments[3]&&(s=arguments[3]);const c={total:{},prefetchCss:{},doCaptureDoc:{},waitForImages:{}};function u(t){t.startTime=Date.now()}function i(t){t.endTime=Date.now(),t.elapsedTime=t.endTime-t.startTime}const l=[];u(c.total);const d=new Set,f=[],m="@@@@@",h="#####",p="-----";u(c.prefetchCss);const g=L(F(fetch,{fetchTimeLimit:s})),y=await g(e);i(c.prefetchCss);const w=U({parseCss:v,CSSImportRule:CSSImportRule,getCssFromCache:y,absolutizeUrl:A,unfetchedToken:h}),C=I({getCssFromCache:y,absolutizeUrl:A}),E=k({extractCssFromNode:C,getBundledCssFromCssText:w,unfetchedToken:h});u(c.doCaptureDoc);const T=function t(a,s=a.location&&a.location.href){const c=new Set;let u="";const i=h(a.documentElement||a);return i.css=u,l.push(D({bgImages:c}).then((t=>i.images=t))),i;function h(e){if(e.hasAttribute&&e.hasAttribute("data-applitools-skip"))return null;const{bundledCss:n,unfetchedResources:o}=E(e,s);if(u+=n,o)for(const t of o)d.add(t);switch(e.nodeType){case x.TEXT:return function(t){return{tagName:"#text",text:t.textContent}}(e);case x.ELEMENT:return"IFRAME"===e.tagName.toUpperCase()?function(e){const n=p(e);let o;try{o=e.contentDocument}catch(e){return r(),n}try{o?n.childNodes=[t(o,R(e)?e.baseURI:o.location.href)]:r()}catch(e){console.log("error in iframeToJSON",e)}return n;function r(){const t=P(e);f.push(t),n.childNodes=[`${m}${t}${m}`]}}(e):p(e);case x.DOCUMENT_FRAGMENT:return{childNodes:Array.prototype.map.call(e.childNodes,h).filter(Boolean)};default:return null}}function p(a){const u=Array.prototype.map.call(a.childNodes,h).filter(Boolean),i=a.shadowRoot&&t(a.shadowRoot,s),l=a.tagName.toUpperCase();if(r.indexOf(l)>-1)return null;const d=e.defaultView.getComputedStyle(a),f=a.getBoundingClientRect(),m={};for(const t of n)m[t]=d.getPropertyValue(t);m["border-width"]||(m["border-width"]=`${d.getPropertyValue("border-top-width")} ${d.getPropertyValue("border-right-width")} ${d.getPropertyValue("border-bottom-width")} ${d.getPropertyValue("border-left-width")}`);const p={};for(const t of o)p[t]=f[t];const g=Array.from(a.attributes).map((t=>({key:t.name,value:t.value}))).reduce(((t,e)=>(t[e.key]=e.value,t)),{}),y=_(d.getPropertyValue("background-image"));y&&c.add(y);const w=O(a);w&&(g["data-applitools-has-pseudo"]=w);const C={tagName:l,style:z(m),rect:z(p),attributes:z(g),childNodes:u};return i&&(C.shadowRoot=i),C}}(e);i(c.doCaptureDoc),u(c.waitForImages),await Promise.all(l),i(c.waitForImages),T.version="1.3.0",T.scriptVersion="11.2.5";const b=f.length?`${f.join("\n")}\n`:"",N=d.size?`${Array.from(d).join("\n")}\n`:"",S=JSON.stringify({separator:p,cssStartToken:h,cssEndToken:h,iframeStartToken:`"${m}`,iframeEndToken:`${m}"`});i(c.total);const $=`${S}\n${N}${p}\n${b}${p}\n${JSON.stringify(T)}${a?`\n${p}\n${JSON.stringify(c)}`:""}`;return console.log("[captureFrame]",JSON.stringify(c)),$;function z(t){return Object.keys(t).length?t:void 0}}))}()};let e=!0;try{let n=document.head.querySelector("[data-applitools-sandbox]");n||(n=document.createElement("iframe"),n.setAttribute("data-applitools-sandbox",""),n.setAttribute("data-applitools-skip",""),document.head.appendChild(n));const o=window.crypto.getRandomValues(new Uint32Array(1))[0],r=n.contentDocument.createElement("script");r.textContent=`window['ctor-${o}'] = ${t.toString()};`,n.contentDocument.head.appendChild(r);const a=n.contentWindow[`ctor-${o}`];if("function"!=typeof a)throw new Error("Sandbox failed to extract function");return e=!1,a(document).apply(null,arguments)}catch(n){try{return t(document).apply(null,arguments)}catch(t){throw e?t:n}}};return t(e)}();

  return captureDom.apply(this, arguments);
}